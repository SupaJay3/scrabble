<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>Anagram Game</title>

<link href="https://fonts.googleapis.com/css2?family=Comfortaa:wght@400;700&display=swap" rel="stylesheet">

<style>
body {
	font-family: "Comfortaa", sans-serif;
	background: linear-gradient(135deg, #eef2f7, #dbeafe);
	display: flex;
	justify-content: center;
	align-items: center;
	min-height: 100vh;
	margin: 0;
}

.container {
	background: white;
	padding: 24px;
	border-radius: 16px;
	width: 420px;
	text-align: center;
	box-shadow: 0 18px 40px rgba(0, 0, 0, 0.12);
	transition: transform 0.2s ease, box-shadow 0.2s ease;
}

.container:hover {
	transform: translateY(-2px);
	box-shadow: 0 22px 50px rgba(0, 0, 0, 0.16);
}

h2 {
	margin-top: 0;
	letter-spacing: 1px;
}

input {
	font-family: inherit;
	padding: 10px 12px;
	width: 80%;
	border-radius: 8px;
	border: 1px solid #ccc;
	font-size: 14px;
	outline: none;
}

input:focus {
	border-color: #6366f1;
	box-shadow: 0 0 0 2px rgba(99, 102, 241, 0.25);
}

button {
	font-family: inherit;
	padding: 8px 14px;
	margin: 6px;
	border-radius: 8px;
	border: none;
	background: #6366f1;
	color: white;
	cursor: pointer;
	font-size: 13px;
	transition: transform 0.1s ease, box-shadow 0.1s ease, background 0.2s;
}

button:hover {
	background: #4f46e5;
	box-shadow: 0 6px 14px rgba(79, 70, 229, 0.35);
}

button:active {
	transform: scale(0.97);
}

button:nth-child(2) {
	background: #ef4444;
}

button:nth-child(2):hover {
	background: #dc2626;
}

.difficulty {
	display: grid;
	grid-template-columns: repeat(2, 1fr);
	gap: 8px;
	margin-top: 14px;
}

.difficulty button {
	background: #f3f4f6;
	color: #111827;
	box-shadow: none;
}

.difficulty button:hover {
	background: #e5e7eb;
}

small {
	display: block;
	font-size: 11px;
	opacity: 0.6;
	margin-top: 2px;
}

#status {
	font-weight: bold;
	margin-top: 8px;
}

#attempts {
	font-size: 13px;
	opacity: 0.8;
}

#answers {
	margin-top: 10px;
	font-size: 13px;
	line-height: 1.4;
}

#currentDiff {
	margin-top: 8px;
	font-size: 12px;
	opacity: 0.7;
}
</style>
</head>

<body>
<div class="container">

<h2 id="prompt">Loadingâ€¦</h2>

<input id="guess" placeholder="Your guess">
<br><br>

<button onclick="submitGuess()">Submit</button>
<button onclick="giveUp()">Give up</button>

<p id="status"></p>
<p id="attempts"></p>

<h3 id="answers"></h3>

<hr>

<div class="difficulty">
    <button onclick="setDifficulty('veryeasy')">Very Easy<br><small>min: 0</small></button>
    <button onclick="setDifficulty('easy')">Easy<br><small>min: 5001</small></button>
    <button onclick="setDifficulty('medium')">Medium<br><small>min: 10001</small></button>
    <button onclick="setDifficulty('hard')">Hard<br><small>min: 20001</small></button>
    <button onclick="setDifficulty('veryhard')">Very Hard<br><small>min: 30001</small></button>
    <button onclick="setDifficulty('impossible')">Impossible<br><small>min: 34001</small></button>
</div>

<p id="currentDiff"></p>

</div>

<script>
let words = [];
let currentSet = null;
let attemptsLeft = 2;

const difficulties = {
    veryeasy: { min: 0 },
    easy: { min: 5001 },
    medium: { min: 10001 },
    hard: { min: 20001 },
    veryhard: { min: 30001 },
    impossible: { min: 34001 }
};

let currentDifficulty = difficulties.veryeasy;

fetch("words.json?v=" + Date.now())
    .then(r => r.json())
    .then(data => {
        words = data;
        generatePuzzle();
    });

function setDifficulty(name) {
    currentDifficulty = difficulties[name];
    document.getElementById("currentDiff").textContent =
        `Difficulty: ${name.toUpperCase()} (min: ${currentDifficulty.min})`;
    generatePuzzle();
}

function generatePuzzle() {
    attemptsLeft = 2;
    document.getElementById("answers").textContent = "";
    document.getElementById("status").textContent = "";

    const grouped = {};

    for (const entry of words) {
        if (!grouped[entry.alphagram]) grouped[entry.alphagram] = [];
        grouped[entry.alphagram].push(entry);
    }

    const validSets = Object.values(grouped).filter(set => {
        const probs = set.map(w => w.probability);
        return Math.min(...probs) >= currentDifficulty.min;
    });

    if (validSets.length === 0) {
        document.getElementById("prompt").textContent = "No words in this difficulty ðŸ˜­";
        currentSet = null;
        return;
    }

    currentSet = validSets[Math.floor(Math.random() * validSets.length)];
    document.getElementById("prompt").textContent =
        `Guess a word for ${currentSet[0].alphagram}`;
    updateAttempts();
}

function submitGuess() {
    if (!currentSet || attemptsLeft <= 0) return;

    const guess = document.getElementById("guess").value.toUpperCase();
    document.getElementById("guess").value = "";

    if (currentSet.some(w => w.word === guess)) {
        document.getElementById("status").textContent = "Correct!";
        revealAnswers();
    } else {
        attemptsLeft--;
        updateAttempts();
        if (attemptsLeft <= 0) giveUp();
    }
}

function giveUp() {
    document.getElementById("status").textContent = "Out of tries.";
    revealAnswers();
}

function revealAnswers() {
    document.getElementById("answers").textContent =
        `Answers (${currentSet.length}): ` +
        currentSet.map(w => `${w.word} (prob: ${w.probability})`).join(", ");
}

function updateAttempts() {
    document.getElementById("attempts").textContent =
        `Attempts left: ${attemptsLeft}`;
}
</script>
</body>
</html>
